# Kitty Configuration - Adorable :3 Terminal for Fedora 42 with NVIDIA on Wayland
# Enhanced with personality and visual flair!

# Display Server Configuration
# Force X11 for NVIDIA/Wayland stability
linux_display_server x11
# Use system colors for Wayland titlebar
wayland_titlebar_color system
# wayland_enable_ime is not enabled (correctly) as it can cause latency and bugs

# Performance Tuning - Balanced values for responsiveness and CPU usage
# Using defaults recommended in official documentation
# 10ms delay between screen updates (official default)
repaint_delay 10
# 3ms input delay (official default)
input_delay 3
# Disable vsync for lower latency
sync_to_monitor no

# Font Configuration
font_family      JetBrainsMono Nerd Font
bold_font        auto
italic_font      auto
bold_italic_font auto
font_size        12.0
disable_ligatures never
force_ltr no
adjust_line_height  110%
adjust_column_width 100%
adjust_baseline 0

# Cursor Customization
cursor_shape block
cursor_beam_thickness 2.0
cursor_blink_interval 0.3
cursor_stop_blinking_after 10.0

# Window Layout
remember_window_size  yes
initial_window_width  1500
initial_window_height 900
window_padding_width 8
window_resize_step_cells 2
window_resize_step_lines 2
hide_window_decorations no
confirm_os_window_close 1

# Tab Bar - Enhanced visual style
tab_bar_edge top
tab_bar_style powerline
tab_powerline_style slanted
tab_bar_min_tabs 1
tab_title_template "{index}: {title[:18]} • THINGS WE THINK ARE COOL :3"
active_tab_font_style   bold-italic
inactive_tab_font_style normal

# Colors and Theme - Enhanced with personality
background_opacity 0.90
dynamic_background_opacity yes
# Include theme - bright Nichijou variant
include themes/nichijou-bright.conf

# Visual Bell - Add some visual feedback :3
enable_audio_bell no
visual_bell_duration 0.2
window_alert_on_bell yes
bell_on_tab yes

# Shell Integration
shell zsh
shell_integration enabled
allow_remote_control yes
listen_on unix:/tmp/kitty-${USER}

# Fun startup message
# Uncomment the following line if you want a startup message
# startup_session none
clipboard_control write-clipboard write-primary read-clipboard read-primary
copy_on_select yes

# Terminal Features
scrollback_lines 20000
scrollback_pager_history_size 20
wheel_scroll_multiplier 7.0
touch_scroll_multiplier 1.5

# URL Handling
url_style straight
open_url_with default
detect_urls yes
url_prefixes file ftp ftps gemini git gopher http https irc ircs kitty mailto news sftp ssh
show_hyperlink_targets yes

# Advanced Features
allow_hyperlinks yes
term xterm-kitty

# Unicode and Emoji Support
unicode_input_encoding utf-8

# Don't check for updates
update_check_interval 0

# Layout Management
enabled_layouts splits,stack,tall,fat,grid,horizontal,vertical
map ctrl+shift+l next_layout

# === Keyboard Shortcuts with Personality ===

# Window Management
map ctrl+shift+enter new_window_with_cwd
map ctrl+shift+n new_os_window_with_cwd
map ctrl+shift+w close_window
map ctrl+shift+] next_window
map ctrl+shift+[ previous_window
map ctrl+shift+f move_window_forward
map ctrl+shift+b move_window_backward
map ctrl+shift+r start_resizing_window
map alt+1 goto_tab 1
map alt+2 goto_tab 2
map alt+3 goto_tab 3
map alt+4 goto_tab 4
map alt+5 goto_tab 5

# Tab Management
map ctrl+shift+t new_tab_with_cwd
map ctrl+shift+q close_tab
map ctrl+shift+. move_tab_forward
map ctrl+shift+, move_tab_backward
map ctrl+shift+alt+t set_tab_title

# Splits - Make it fun!
map f1 launch --location=hsplit --cwd=current
map f2 launch --location=vsplit --cwd=current
map f3 layout_action rotate
map ctrl+left neighboring_window left
map ctrl+right neighboring_window right
map ctrl+up neighboring_window up
map ctrl+down neighboring_window down
map ctrl+shift+left move_window left
map ctrl+shift+right move_window right
map ctrl+shift+up move_window up
map ctrl+shift+down move_window down

# Font Sizes
map ctrl+shift+plus change_font_size all +1.0
map ctrl+shift+minus change_font_size all -1.0
map ctrl+shift+0 change_font_size all 0
map ctrl+shift+backspace restore_font_size

# Scrolling
map ctrl+shift+k scroll_line_up
map ctrl+shift+j scroll_line_down
map ctrl+shift+page_up scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end
map ctrl+shift+h show_scrollback
map ctrl+shift+o show_last_command_output

# Fun and Useful Shortcuts :3
map ctrl+shift+f2 edit_config_file
map ctrl+shift+f5 load_config_file
map ctrl+shift+f6 debug_config
map ctrl+shift+u kitten unicode_input
map ctrl+shift+e open_url_with_hints
map ctrl+shift+p>f kitten hints --type path --program -
map ctrl+shift+p>w kitten hints --type word --program -
map ctrl+shift+p>h kitten hints --type hash --program -
map ctrl+shift+p>l kitten hints --type line --program -
map ctrl+shift+a>m set_background_opacity +0.05
map ctrl+shift+a>l set_background_opacity -0.05
map ctrl+shift+a>1 set_background_opacity 1
map ctrl+shift+a>d set_background_opacity default

# Extra fun shortcuts :3
map ctrl+shift+z kitten hyperlinked_grep  # Search with hyperlinks
map ctrl+shift+x kitten themes            # Quick theme switcher
# Clipboard management (moved to Alt to avoid conflict with copy)
map ctrl+shift+alt+c kitten clipboard    # Clipboard management
map ctrl+shift+alt+h paste_from_history  # Paste history browser
map ctrl+shift+n load_config_file ~/.config/kitty/themes/nichijou-bright.conf  # Switch to Nichijou Bright theme
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard

# Built-in kittens wiring
map ctrl+shift+i kitten icat --hold        # Image preview in terminal
map ctrl+shift+d kitten diff               # Side-by-side diff with syntax highlighting
map ctrl+shift+b kitten broadcast --toggle # Toggle broadcast typing to other windows

# Show Nichijou motto in a bottom panel (1 line)
map ctrl+shift+; kitten panel --position bottom --height 1 "$HOME/.local/bin/nichijou_motto"

# Help overlay (panel) — shows custom keybindings; press any key to close
map ctrl+shift+f1 kitten panel --position top --height 16 "$HOME/.local/bin/kitty_help"

# Quick access terminal (floating overlay)
map ctrl+grave_accent kitten quickterminal

# Fonts viewer/tuner
map ctrl+shift+alt+f kitten fonts

# Remote file helper (open/edit/download over SSH sessions)
map ctrl+shift+alt+r kitten remote_file

# Seamless file transfer over existing SSH sessions
map ctrl+shift+alt+t kitten transfer

# Select window from visual chooser
map ctrl+shift+g select_window
# Selection behavior: treat common filename/path chars as part of words
select_by_word_characters :-_./


# Context menu (right click) — open a features menu
# Open menu on right-click release (works even if app grabs mouse)
mouse_map right release ungrabbed kitten panel --position top --height 20 /home/miko/.local/bin/kitty_menu
mouse_map right release grabbed   kitten panel --position top --height 20 /home/miko/.local/bin/kitty_menu
# Alternate: Alt+Right-Click pastes from clipboard on release
mouse_map alt+right release ungrabbed paste_from_clipboard
# Keyboard fallback to open menu
map ctrl+shift+m kitten panel --position top --height 20 /home/miko/.local/bin/kitty_menu
